{% extends "base.html" %}

{% block title %}Gerenciar Separa√ß√µes{% endblock %}

{% block content %}
<section class="form-container" style="max-width: 1400px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h2>Gerenciar Separa√ß√µes (Vis√£o de Tabela)</h2>
    </div>
    <p>Visualize todas as separa√ß√µes em formato de planilha. Edi√ß√µes feitas aqui ser√£o refletidas na p√°gina principal de
        Separa√ß√µes.</p>

    <div style="margin: 2rem 0;">
        <input type="search" id="filtro-tabela-separacoes" placeholder="üîé Buscar em todas as colunas...">
    </div>

    <!-- MUDAN√áA: O spinner agora est√° fora da tabela -->
    <div id="loading-spinner-tabela" class="spinner" style="display: block; margin: 2rem auto;"></div>

    <table id="tabela-separacoes" class="admin-table" style="display: none; width: 100%; margin-top: 2rem;">
        <thead>
            <tr>
                <th>N¬∫ Mov.</th>
                <th>Cliente</th>
                <th>Vendedor</th>
                <th>Separador</th>
                <th>Conferente</th>
                <th>Data Cria√ß√£o</th>
                <th>Data Finaliza√ß√£o</th>
                <th style="width: 120px;">A√ß√µes</th>
            </tr>
        </thead>
        <tbody id="tabela-separacoes-body"></tbody>
    </table>

    <!-- NOVO: Container de pagina√ß√£o para o spinner de "carregar mais" -->
    <div id="pagination-container-tabela" class="pagination-container">
        <div id="loading-more-spinner" class="spinner" style="display: none;"></div>
    </div>
</section>

<div id="edit-separacao-modal-overlay" class="modal-overlay" style="display:none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="edit-separacao-modal-title">Editar Separa√ß√£o</h2>
            <button class="close-modal close-modal-icon">√ó</button>
        </div>
        <form id="form-edit-separacao" novalidate>
            <div class="modal-body">
                <div class="layout-grid-2-cols" style="gap: 1rem;">
                    <div class="form-group"><label>N¬∫ Movimenta√ß√£o</label><input type="number"
                            id="edit-numero-movimentacao" required></div>
                    <div class="form-group"><label>Qtd. Pe√ßas</label><input type="number" id="edit-qtd-pecas" required>
                    </div>
                </div>
                <div class="form-group"><label>Nome do Cliente</label><input type="text" id="edit-nome-cliente"
                        required></div>
                <div class="form-group"><label>Vendedor</label><select id="edit-vendedor-nome" required></select></div>
                <div class="form-group">
                    <label>Separador(es)</label>
                    <div id="edit-separador-container" class="permissions-grid"
                        style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); border: 1px solid var(--border-strong); padding: 0.75rem; border-radius: var(--border-radius);">
                    </div>
                </div>
                <div class="form-group"><label>Conferente</label><select id="edit-conferente-nome"></select></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn--secondary close-modal">Cancelar</button>
                <button type="submit" id="btn-save-edit-separacao" class="btn btn--primary">Salvar Altera√ß√µes</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}